<div class="row lightbox" style="display:none;"
    tal:condition="view/enabled">
    <div class="col-xs-12"
         tal:define="scale_func view/lightbox/@@images;
             scaled_image python: getattr(view.lightbox.aq_explicit, 'image', False) and scale_func.scale('image')">
        <a href="${scaled_image/url|nothing}"
            data-fancybox="${view/lightbox/id}"
            data-caption="${view/lightbox/image_caption}"
            data-goto="${view/lightbox/lightbox_url}"
            data-options=''>
            <img src="" alt="" />
        </a>

    </div>
    <script>
    $( document ).ready(function() {
        $.fancybox.open($('.lightbox [data-fancybox]'), {
            buttons: [
            'close'
            ],
            caption : function( instance, item ) {
                var caption = $(this).data('caption') || '';
                var url = $(this).data('goto') || '';

                if ( url.length ) {
			caption = '<div class="captionwrapper"><a class="captionbutton" href="' + url + '">' + caption + '</a></div>' ;
                }
                return caption;
              }
        });
    })
    </script>   
</div>
